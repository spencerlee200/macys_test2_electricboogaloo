window.libpannellum=function(e,t,a){function r(r,n,d,l){function c(e,t){return 1==e.level&&1!=t.level?-1:1==t.level&&1!=e.level?1:t.timestamp-e.timestamp}function f(e,t){return e.level!=t.level?e.level-t.level:e.diff-t.diff}function m(){if(!B.drawInProgress){B.drawInProgress=!0;for(var e=0;e<B.currentNodes.length;e++)B.currentNodes[e].textureLoaded&&(L.bindBuffer(L.ARRAY_BUFFER,B.cubeVertBuf),L.bufferData(L.ARRAY_BUFFER,new Float32Array(B.currentNodes[e].vertices),L.STATIC_DRAW),L.vertexAttribPointer(B.vertPosLocation,3,L.FLOAT,!1,0,0),L.bindBuffer(L.ARRAY_BUFFER,B.cubeVertTexCoordBuf),L.vertexAttribPointer(B.texCoordLocation,2,L.FLOAT,!1,0,0),L.bindTexture(L.TEXTURE_2D,B.currentNodes[e].texture),L.drawElements(L.TRIANGLES,6,L.UNSIGNED_SHORT,0));B.drawInProgress=!1}}function _(e,t,a,r,i,o){this.vertices=e,this.side=t,this.level=a,this.x=r,this.y=i,this.path=o.replace("%s",t).replace("%l",a).replace("%x",r).replace("%y",i)}function g(e,t,a,r,i){if(C(e,t.vertices)){var o=t.vertices,h=o[0]+o[3]+o[6]+o[9],s=o[1]+o[4]+o[7]+o[10],u=o[2]+o[5]+o[8]+o[11],d=Math.sqrt(h*h+s*s+u*u),l=Math.asin(u/d),c=Math.atan2(s,h),f=c-r;f+=f>Math.PI?-2*Math.PI:f<-Math.PI?2*Math.PI:0,f=Math.abs(f),t.diff=Math.acos(Math.sin(a)*Math.sin(l)+Math.cos(a)*Math.cos(l)*Math.cos(f));for(var m=!1,p=0;p<B.nodeCache.length;p++)if(B.nodeCache[p].path==t.path){m=!0,B.nodeCache[p].timestamp=B.nodeCacheTimestamp++,B.nodeCache[p].diff=t.diff,B.currentNodes.push(B.nodeCache[p]);break}if(m||(t.timestamp=B.nodeCacheTimestamp++,B.currentNodes.push(t),B.nodeCache.push(t)),t.level<B.level){var E=n.cubeResolution*Math.pow(2,t.level-n.maxLevel),v=Math.ceil(E*n.invTileResolution)-1,x=E%n.tileResolution*2,R=2*E%n.tileResolution;0===R&&(R=n.tileResolution),0===x&&(x=2*n.tileResolution);var T=.5;t.x!=v&&t.y!=v||(T=1-n.tileResolution/(n.tileResolution+R));var M,w,A=1-T,b=[],I=T,P=T,U=T,L=A,N=A,D=A;R<n.tileResolution&&(t.x==v&&t.y!=v?(P=.5,N=.5,"d"!=t.side&&"u"!=t.side||(U=.5,D=.5)):t.x!=v&&t.y==v&&(I=.5,L=.5,"l"!=t.side&&"r"!=t.side||(U=.5,D=.5))),x<n.tileResolution&&(t.x==v&&(I=0,L=1,"l"!=t.side&&"r"!=t.side||(U=0,D=1)),t.y==v&&(P=0,N=1,"d"!=t.side&&"u"!=t.side||(U=0,D=1))),M=[o[0],o[1],o[2],o[0]*I+o[3]*L,o[1]*T+o[4]*A,o[2]*U+o[5]*D,o[0]*I+o[6]*L,o[1]*P+o[7]*N,o[2]*U+o[8]*D,o[0]*T+o[9]*A,o[1]*P+o[10]*N,o[2]*U+o[11]*D],w=new _(M,t.side,t.level+1,2*t.x,2*t.y,n.fullpath),b.push(w),t.x==v&&x<n.tileResolution||(M=[o[0]*I+o[3]*L,o[1]*T+o[4]*A,o[2]*U+o[5]*D,o[3],o[4],o[5],o[3]*T+o[6]*A,o[4]*P+o[7]*N,o[5]*U+o[8]*D,o[0]*I+o[6]*L,o[1]*P+o[7]*N,o[2]*U+o[8]*D],w=new _(M,t.side,t.level+1,2*t.x+1,2*t.y,n.fullpath),b.push(w)),t.x==v&&x<n.tileResolution||t.y==v&&x<n.tileResolution||(M=[o[0]*I+o[6]*L,o[1]*P+o[7]*N,o[2]*U+o[8]*D,o[3]*T+o[6]*A,o[4]*P+o[7]*N,o[5]*U+o[8]*D,o[6],o[7],o[8],o[9]*I+o[6]*L,o[10]*T+o[7]*A,o[11]*U+o[8]*D],w=new _(M,t.side,t.level+1,2*t.x+1,2*t.y+1,n.fullpath),b.push(w)),t.y==v&&x<n.tileResolution||(M=[o[0]*T+o[9]*A,o[1]*P+o[10]*N,o[2]*U+o[11]*D,o[0]*I+o[6]*L,o[1]*P+o[7]*N,o[2]*U+o[8]*D,o[9]*I+o[6]*L,o[10]*T+o[7]*A,o[11]*U+o[8]*D,o[9],o[10],o[11]],w=new _(M,t.side,t.level+1,2*t.x,2*t.y+1,n.fullpath),b.push(w));for(var y=0;y<b.length;y++)g(e,b[y],a,r,i)}}}function p(){return[-1,1,-1,1,1,-1,1,-1,-1,-1,-1,-1,1,1,1,-1,1,1,-1,-1,1,1,-1,1,-1,1,1,1,1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1,1,-1,1,-1,-1,1,-1,1,1,-1,1,-1,-1,-1,-1,-1,-1,1,1,1,-1,1,1,1,1,-1,1,1,-1,-1]}function E(){return[1,0,0,0,1,0,0,0,1]}function v(e,t,a){var r=Math.sin(t),i=Math.cos(t);return"x"==a?[e[0],i*e[1]+r*e[2],i*e[2]-r*e[1],e[3],i*e[4]+r*e[5],i*e[5]-r*e[4],e[6],i*e[7]+r*e[8],i*e[8]-r*e[7]]:"y"==a?[i*e[0]-r*e[2],e[1],i*e[2]+r*e[0],i*e[3]-r*e[5],e[4],i*e[5]+r*e[3],i*e[6]-r*e[8],e[7],i*e[8]+r*e[6]]:void 0}function x(e){return[e[0],e[1],e[2],0,e[3],e[4],e[5],0,e[6],e[7],e[8],0,0,0,0,1]}function R(e){return[e[0],e[4],e[8],e[12],e[1],e[5],e[9],e[13],e[2],e[6],e[10],e[14],e[3],e[7],e[11],e[15]]}function T(e,t,a,r){var i=2*Math.atan(Math.tan(e/2)*U.height/U.width),o=1/Math.tan(i/2);return[o/t,0,0,0,0,o,0,0,0,0,(r+a)/(a-r),2*r*a/(a-r),0,0,-1,0]}function M(e,t){L.bindTexture(L.TEXTURE_2D,t),L.texImage2D(L.TEXTURE_2D,0,L.RGB,L.RGB,L.UNSIGNED_BYTE,e),L.texParameteri(L.TEXTURE_2D,L.TEXTURE_MAG_FILTER,L.LINEAR),L.texParameteri(L.TEXTURE_2D,L.TEXTURE_MIN_FILTER,L.LINEAR),L.texParameteri(L.TEXTURE_2D,L.TEXTURE_WRAP_S,L.CLAMP_TO_EDGE),L.texParameteri(L.TEXTURE_2D,L.TEXTURE_WRAP_T,L.CLAMP_TO_EDGE),L.bindTexture(L.TEXTURE_2D,null)}function w(e){e.texture||(e.texture=L.createTexture(),e.image=new Image,e.image.crossOrigin="anonymous",e.image.onload=function(){M(e.image,e.texture),e.textureLoaded=!0,delete e.image},e.image.src=encodeURI(e.path+"."+n.extension))}function A(e){for(var t=1;t<n.maxLevel&&U.width>n.tileResolution*Math.pow(2,t-1)*Math.tan(e/2)*.707;)t++;B.level=t}function b(e,t){return[e[0]*t[0],e[0]*t[1],e[0]*t[2],0,e[5]*t[4],e[5]*t[5],e[5]*t[6],0,e[10]*t[8],e[10]*t[9],e[10]*t[10],e[11],-t[8],-t[9],-t[10],0]}function I(e,t){return[e[0]*t[0]+e[1]*t[1]+e[2]*t[2],e[4]*t[0]+e[5]*t[1]+e[6]*t[2],e[11]+e[8]*t[0]+e[9]*t[1]+e[10]*t[2],1/(e[12]*t[0]+e[13]*t[1]+e[14]*t[2])]}function P(e,t){var a=I(e,t),r=a[0]*a[3],i=a[1]*a[3],o=a[2]*a[3],n=[0,0,0];return r<-1&&(n[0]=-1),r>1&&(n[0]=1),i<-1&&(n[1]=-1),i>1&&(n[1]=1),(o<-1||o>1)&&(n[2]=1),n}function C(e,t){var a=P(e,t.slice(0,3)),r=P(e,t.slice(3,6)),i=P(e,t.slice(6,9)),o=P(e,t.slice(9,12)),n=a[0]+r[0]+i[0]+o[0];if(-4==n||4==n)return!1;var h=a[1]+r[1]+i[1]+o[1];return-4!=h&&4!=h&&4!=a[2]+r[2]+i[2]+o[2]}var U=t.createElement("canvas");U.classList?U.classList.add("libpannellum"):U.className+=" libpannellum",U.style.width=U.style.height="100%",r.appendChild(U),typeof d===a&&(d="equirectangular");var B,L,N,D,y,S;this.init=function(e,l,c,f,m){var _;if("cubemap"==d&&0!=(n[0].width&n[0].width-1)&&(navigator.userAgent.toLowerCase().match(/(iphone|ipod|ipad).* os 8_/)||navigator.userAgent.toLowerCase().match(/(iphone|ipod|ipad).* os 9_/)||navigator.userAgent.match(/Trident.*rv[ :]*11\./))||(L=U.getContext("experimental-webgl",{alpha:!1,depth:!1})),!L&&("multires"==d&&n.hasOwnProperty("fallbackPath")||"cubemap"==d)&&("WebkitAppearance"in t.documentElement.style||navigator.userAgent.match(/Trident.*rv[ :]*11\./)||-1!==navigator.appVersion.indexOf("MSIE 10"))){D&&r.removeChild(D),D=t.createElement("div"),D.className="pnlm-world";var g;g=n.basePath?n.basePath+n.fallbackPath:n.fallbackPath;var E=["f","r","b","l","u","d"],v=0,x=function(){var e=t.createElement("canvas");e.className="pnlm-face pnlm-"+E[this.side]+"face",D.appendChild(e);var a=e.getContext("2d");e.style.width=this.width+4+"px",e.style.height=this.height+4+"px",e.width=this.width+4,e.height=this.height+4,a.drawImage(this,2,2);var i,o,n=a.getImageData(0,0,e.width,e.height),h=n.data;for(i=2;i<e.width-2;i++)for(o=0;o<4;o++)h[4*(i+e.width)+o]=h[4*(i+2*e.width)+o],h[4*(i+e.width*(e.height-2))+o]=h[4*(i+e.width*(e.height-3))+o];for(i=2;i<e.height-2;i++)for(o=0;o<4;o++)h[4*(i*e.width+1)+o]=h[4*(i*e.width+2)+o],h[4*((i+1)*e.width-2)+o]=h[4*((i+1)*e.width-3)+o];for(o=0;o<4;o++)h[4*(e.width+1)+o]=h[4*(2*e.width+2)+o],h[4*(2*e.width-2)+o]=h[4*(3*e.width-3)+o],h[4*(e.width*(e.height-2)+1)+o]=h[4*(e.width*(e.height-3)+2)+o],h[4*(e.width*(e.height-1)-2)+o]=h[4*(e.width*(e.height-2)-3)+o];for(i=1;i<e.width-1;i++)for(o=0;o<4;o++)h[4*i+o]=h[4*(i+e.width)+o],h[4*(i+e.width*(e.height-1))+o]=h[4*(i+e.width*(e.height-2))+o];for(i=1;i<e.height-1;i++)for(o=0;o<4;o++)h[i*e.width*4+o]=h[4*(i*e.width+1)+o],h[4*((i+1)*e.width-1)+o]=h[4*((i+1)*e.width-2)+o];for(o=0;o<4;o++)h[o]=h[4*(e.width+1)+o],h[4*(e.width-1)+o]=h[4*(2*e.width-2)+o],h[e.width*(e.height-1)*4+o]=h[4*(e.width*(e.height-2)+1)+o],h[4*(e.width*e.height-1)+o]=h[4*(e.width*(e.height-1)-2)+o];a.putImageData(n,0,0),6==++v&&(N=this.width,r.appendChild(D),f())};for(_=0;_<6;_++){var R=new Image;R.crossOrigin="anonymous",R.side=_,R.onload=x,R.src="multires"==d?encodeURI(g.replace("%s",E[_])+"."+n.extension):encodeURI(n[_].src)}}else{if(!L)throw console.log("Error: no WebGL support detected!"),{type:"no webgl"};n.basePath?n.fullpath=n.basePath+n.path:n.fullpath=n.path,n.invTileResolution=1/n.tileResolution;var T=p();for(y=[],_=0;_<6;_++)y[_]=T.slice(12*_,12*_+12),T=p();var M,w;if("equirectangular"==d){if(M=Math.max(n.width,n.height),w=L.getParameter(L.MAX_TEXTURE_SIZE),M>w)throw console.log("Error: The image is too big; it's "+M+"px wide, but this device's maximum supported width is "+w+"px."),{type:"webgl size error",width:M,maxWidth:w}}else if("cubemap"==d&&(M=n[0].width,w=L.getParameter(L.MAX_CUBE_MAP_TEXTURE_SIZE),M>w))throw console.log("Error: The cube face image is too big; it's "+M+"px wide, but this device's maximum supported width is "+w+"px."),{type:"webgl size error",width:M,maxWidth:w};n.horizonPitch!==a&&n.horizonRoll!==a&&(S=[n.horizonPitch,n.horizonRoll]);var A=L.TEXTURE_2D;L.viewport(0,0,U.width,U.height);var b=L.createShader(L.VERTEX_SHADER),I=i;"multires"==d&&(I=o),L.shaderSource(b,I),L.compileShader(b);var P=L.createShader(L.FRAGMENT_SHADER),C=s;"cubemap"==d?(A=L.TEXTURE_CUBE_MAP,C=h):"multires"==d&&(C=u),L.shaderSource(P,C),L.compileShader(P),B=L.createProgram(),L.attachShader(B,b),L.attachShader(B,P),L.linkProgram(B),m&&L.pixelStorei(L.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!0),L.getShaderParameter(b,L.COMPILE_STATUS)||console.log(L.getShaderInfoLog(b)),L.getShaderParameter(P,L.COMPILE_STATUS)||console.log(L.getShaderInfoLog(P)),L.getProgramParameter(B,L.LINK_STATUS)||console.log(L.getProgramInfoLog(B)),L.useProgram(B),B.drawInProgress=!1,B.texCoordLocation=L.getAttribLocation(B,"a_texCoord"),L.enableVertexAttribArray(B.texCoordLocation),"multires"!=d?(B.texCoordBuffer=L.createBuffer(),L.bindBuffer(L.ARRAY_BUFFER,B.texCoordBuffer),L.bufferData(L.ARRAY_BUFFER,new Float32Array([-1,1,1,1,1,-1,-1,1,1,-1,-1,-1]),L.STATIC_DRAW),L.vertexAttribPointer(B.texCoordLocation,2,L.FLOAT,!1,0,0),B.aspectRatio=L.getUniformLocation(B,"u_aspectRatio"),L.uniform1f(B.aspectRatio,U.width/U.height),B.psi=L.getUniformLocation(B,"u_psi"),B.theta=L.getUniformLocation(B,"u_theta"),B.f=L.getUniformLocation(B,"u_f"),B.h=L.getUniformLocation(B,"u_h"),B.v=L.getUniformLocation(B,"u_v"),B.vo=L.getUniformLocation(B,"u_vo"),B.rot=L.getUniformLocation(B,"u_rot"),L.uniform1f(B.h,e/(2*Math.PI)),L.uniform1f(B.v,l/Math.PI),L.uniform1f(B.vo,c/Math.PI*2),B.texture=L.createTexture(),L.bindTexture(A,B.texture),"cubemap"==d?(L.texImage2D(L.TEXTURE_CUBE_MAP_POSITIVE_X,0,L.RGB,L.RGB,L.UNSIGNED_BYTE,n[1]),L.texImage2D(L.TEXTURE_CUBE_MAP_NEGATIVE_X,0,L.RGB,L.RGB,L.UNSIGNED_BYTE,n[3]),L.texImage2D(L.TEXTURE_CUBE_MAP_POSITIVE_Y,0,L.RGB,L.RGB,L.UNSIGNED_BYTE,n[4]),L.texImage2D(L.TEXTURE_CUBE_MAP_NEGATIVE_Y,0,L.RGB,L.RGB,L.UNSIGNED_BYTE,n[5]),L.texImage2D(L.TEXTURE_CUBE_MAP_POSITIVE_Z,0,L.RGB,L.RGB,L.UNSIGNED_BYTE,n[0]),L.texImage2D(L.TEXTURE_CUBE_MAP_NEGATIVE_Z,0,L.RGB,L.RGB,L.UNSIGNED_BYTE,n[2])):L.texImage2D(A,0,L.RGB,L.RGB,L.UNSIGNED_BYTE,n),L.texParameteri(A,L.TEXTURE_WRAP_S,L.CLAMP_TO_EDGE),L.texParameteri(A,L.TEXTURE_WRAP_T,L.CLAMP_TO_EDGE),L.texParameteri(A,L.TEXTURE_MIN_FILTER,L.LINEAR),L.texParameteri(A,L.TEXTURE_MAG_FILTER,L.LINEAR)):(B.vertPosLocation=L.getAttribLocation(B,"a_vertCoord"),L.enableVertexAttribArray(B.vertPosLocation),B.cubeVertBuf=L.createBuffer(),B.cubeVertTexCoordBuf=L.createBuffer(),B.cubeVertIndBuf=L.createBuffer(),L.bindBuffer(L.ARRAY_BUFFER,B.cubeVertTexCoordBuf),L.bufferData(L.ARRAY_BUFFER,new Float32Array([0,0,1,0,1,1,0,1]),L.STATIC_DRAW),L.bindBuffer(L.ELEMENT_ARRAY_BUFFER,B.cubeVertIndBuf),L.bufferData(L.ELEMENT_ARRAY_BUFFER,new Uint16Array([0,1,2,0,2,3]),L.STATIC_DRAW),B.perspUniform=L.getUniformLocation(B,"u_perspMatrix"),B.cubeUniform=L.getUniformLocation(B,"u_cubeMatrix"),B.level=-1,B.currentNodes=[],B.nodeCache=[],B.nodeCacheTimestamp=0);var G=L.getError();if(0!==L.getError())throw console.log("Error: Something went wrong with WebGL!"+G),{type:"webgl error"};f()}},this.destroy=function(){r!==a&&(U!==a&&r.removeChild(U),D!==a&&r.removeChild(D))},this.resize=function(){var t=e.devicePixelRatio||1;U.width=U.clientWidth*t,U.height=U.clientHeight*t,L&&(L.viewport(0,0,U.width,U.height),"multires"!=d&&L.uniform1f(B.aspectRatio,U.width/U.height))},this.resize(),this.render=function(t,r,i,o){var h,s,u;if(L||"multires"!=d&&"cubemap"!=d){if("multires"!=d){var p=2*Math.atan(Math.tan(.5*i)/(U.width/U.height));if(h=1/Math.tan(.5*p),"equirectangular"==d&&S!==a){var M=S[0],I=S[1],P=t,C=r,G=Math.cos(I)*Math.sin(t)*Math.sin(M)+Math.cos(t)*(Math.cos(M)*Math.cos(r)+Math.sin(I)*Math.sin(M)*Math.sin(r)),X=-Math.sin(t)*Math.sin(I)+Math.cos(t)*Math.cos(I)*Math.sin(r),F=Math.cos(I)*Math.cos(M)*Math.sin(t)+Math.cos(t)*(-Math.cos(r)*Math.sin(M)+Math.cos(M)*Math.sin(I)*Math.sin(r));t=Math.asin(F),r=Math.atan2(X,G);var Y=[Math.cos(P)*(Math.sin(I)*Math.sin(M)*Math.cos(C)-Math.cos(M)*Math.sin(C)),Math.cos(P)*Math.cos(I)*Math.cos(C),Math.cos(P)*(Math.cos(M)*Math.sin(I)*Math.cos(C)+Math.sin(C)*Math.sin(M))],O=[-Math.cos(t)*Math.sin(r),Math.cos(t)*Math.cos(r)],V=Math.acos((Y[0]*O[0]+Y[1]*O[1])/(Math.sqrt(Y[0]*Y[0]+Y[1]*Y[1]+Y[2]*Y[2])*Math.sqrt(O[0]*O[0]+O[1]*O[1])));Y[2]<0&&(V=2*Math.PI-V),L.uniform1f(B.rot,V)}L.uniform1f(B.psi,r),L.uniform1f(B.theta,t),L.uniform1f(B.f,h),!0===l&&"equirectangular"==d&&(L.bindTexture(L.TEXTURE_2D,B.texture),L.texImage2D(L.TEXTURE_2D,0,L.RGB,L.RGB,L.UNSIGNED_BYTE,n)),L.drawArrays(L.TRIANGLES,0,6)}else{var W=T(i,U.width/U.height,.1,100);A(i);var k=E();k=v(k,-t,"x"),k=v(k,r,"y"),k=x(k),L.uniformMatrix4fv(B.perspUniform,!1,new Float32Array(R(W))),L.uniformMatrix4fv(B.cubeUniform,!1,new Float32Array(R(k)));var q=b(W,k);B.nodeCache.sort(c),B.nodeCache.length>200&&B.nodeCache.length>B.currentNodes.length+50&&B.nodeCache.splice(200,B.nodeCache.length-200),B.currentNodes=[];var z=["f","b","u","d","l","r"];for(u=0;u<6;u++){g(q,new _(y[u],z[u],1,0,0,n.fullpath),t,r,i)}for(B.currentNodes.sort(f),s=0;s<B.currentNodes.length;s++)if(!B.currentNodes[s].texture){setTimeout(w(B.currentNodes[s]),0);break}m()}if(o!==a)return U.toDataURL("image/png")}else{u=N/2;var j={f:"translate3d(-"+(u+2)+"px, -"+(u+2)+"px, -"+u+"px)",b:"translate3d("+(u+2)+"px, -"+(u+2)+"px, "+u+"px) rotateX(180deg) rotateZ(180deg)",u:"translate3d(-"+(u+2)+"px, -"+u+"px, "+(u+2)+"px) rotateX(270deg)",d:"translate3d(-"+(u+2)+"px, "+u+"px, -"+(u+2)+"px) rotateX(90deg)",l:"translate3d(-"+u+"px, -"+(u+2)+"px, "+(u+2)+"px) rotateX(180deg) rotateY(90deg) rotateZ(180deg)",r:"translate3d("+u+"px, -"+(u+2)+"px, -"+(u+2)+"px) rotateY(270deg)"};h=1/Math.tan(i/2);var Z=h*U.width/(e.devicePixelRatio||1)/2+"px",H="perspective("+Z+") translateZ("+Z+") rotateX("+t+"rad) rotateY("+r+"rad) ",K=Object.keys(j);for(s=0;s<6;s++){var J=D.querySelector(".pnlm-"+K[s]+"face").style;J.webkitTransform=H+j[K[s]],J.transform=H+j[K[s]]}}},this.isLoading=function(){if(L&&"multires"==d)for(var e=0;e<B.currentNodes.length;e++)if(!B.currentNodes[e].textureLoaded)return!0;return!1},this.getCanvas=function(){return U}}var i=["attribute vec2 a_texCoord;","varying vec2 v_texCoord;","void main() {","gl_Position = vec4(a_texCoord, 0.0, 1.0);","v_texCoord = a_texCoord;","}"].join(""),o=["attribute vec3 a_vertCoord;","attribute vec2 a_texCoord;","uniform mat4 u_cubeMatrix;","uniform mat4 u_perspMatrix;","varying mediump vec2 v_texCoord;","void main(void) {","gl_Position = u_perspMatrix * u_cubeMatrix * vec4(a_vertCoord, 1.0);","v_texCoord = a_texCoord;","}"].join(""),n=["precision mediump float;","uniform float u_aspectRatio;","uniform float u_psi;","uniform float u_theta;","uniform float u_f;","uniform float u_h;","uniform float u_v;","uniform float u_vo;","uniform float u_rot;","const float PI = 3.14159265358979323846264;","uniform sampler2D u_image;","uniform samplerCube u_imageCube;","varying vec2 v_texCoord;","uniform vec4 u_backgroundColor;","void main() {","float x = v_texCoord.x * u_aspectRatio;","float y = v_texCoord.y;","float sintheta = sin(u_theta);","float costheta = cos(u_theta);","float a = u_f * costheta - y * sintheta;","float root = inversesqrt(x * x + a * a);","float lambda = atan(x * root, a * root) + u_psi;","float phi = atan((y * costheta + u_f * sintheta) * root);"].join("\n"),h=n+["float cosphi = cos(phi);","gl_FragColor = textureCube(u_imageCube, vec3(cosphi*sin(lambda), sin(phi), cosphi*cos(lambda)));","}"].join("\n"),s=n+["lambda = mod(lambda + PI, PI * 2.0) - PI;","vec2 coord = vec2(lambda / PI, phi / (PI / 2.0));","gl_FragColor = texture2D(u_image, vec2((coord.x + u_h) / (u_h * 2.0), (-coord.y + u_v + u_vo) / (u_v * 2.0)));","}"].join("\n"),u=["varying mediump vec2 v_texCoord;","uniform sampler2D u_sampler;","void main(void) {","gl_FragColor = texture2D(u_sampler, v_texCoord);","}"].join("");return{renderer:function(e,t,a,i){return new r(e,t,a,i)}}}(window,document);