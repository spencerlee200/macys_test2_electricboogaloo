wwplayer.define(["jquery","BaseWidget",window.wirewax.toolkit,"underscore","raphael","apiService","globals","iscroll","require-shim","pubsub"],function(e,t,a,o,n,i,l,s,r,c){var d;return t.extend({init:function(t){d=this,this.hasTemplate=!1,this.cacheTemplate=!0,this.appRef=t.appRef,this.overlayId=t.overlayId,this.postAnimationCallbacks=[],this.aggresiveScaling=!1,this.noScale=!1,this.linearScaling=!1,this.carouselAutpolay=!1,this.customFonts=[{fontFolder:"creativeData/fonts/glkahnregular/",fontName:"glkahnregular",fontFileName:"glkahnregular",forceTTF:!1},{fontFolder:"creativeData/fonts/glbaderregular/",fontName:"glbaderregular",fontFileName:"glbaderregular",forceTTF:!1},{fontFolder:"creativeData/fonts/glbaderextendedregular/",fontName:"glbaderextendedregular",fontFileName:"glbaderextendedregular",forceTTF:!1},{fontFolder:"creativeData/fonts/glbadercompressblack/",fontName:"glbadercompressblack",fontFileName:"glbadercompressblack",forceTTF:!1},{fontFolder:"creativeData/fonts/emprint/",fontName:"emprint",fontFileName:"emprint",forceTTF:!1},{fontFolder:"creativeData/fonts/thirsty/",fontName:"Thirsty",fontFileName:"ThirstyScriptRegular",forceTTF:!1},{fontFolder:"creativeData/fonts/titilliumweb/",fontName:"Titillium",fontFileName:"Titillium%20Web",forceTTF:!1},{fontFolder:"creativeData/fonts/titilliumwebsemibold/",fontName:"Titillium SemiBold",fontFileName:"Titillium%20WebSemiBold",forceTTF:!1},{fontFolder:"creativeData/fonts/apercu/",fontName:"apercu",fontFileName:"apercu_regular",forceTTF:!1},{fontFolder:"creativeData/fonts/tungstenmedium/",fontName:"tungstenmedium",fontFileName:"tungstenmedium",forceTTF:!1},{fontFolder:"creativeData/fonts/texgyreadventor-regular/",fontName:"texgyreadventor-regular",fontFileName:"texgyreadventor-regular",forceTTF:!1},{fontFolder:"creativeData/fonts/Gotham-Bold/",fontName:"Gotham-Bold",fontFileName:"Gotham-Bold",forceTTF:!1},{fontFolder:"creativeData/fonts/Gotham-Book/",fontName:"Gotham-Book",fontFileName:"Gotham-Book",forceTTF:!1},{fontFolder:"creativeData/fonts/adihausdin-regular/",fontName:"adihausdin-regular",fontFileName:"adihausdin-regular",forceTTF:!1},{fontFolder:"creativeData/fonts/QStencil/",fontName:"QStencil",fontFileName:"QStencil",forceTTF:!1},{fontFolder:"creativeData/fonts/Stag%20ATT/stagatt/",fontName:"Stag_ATT",fontFileName:"stagatt_medium",forceTTF:!1,options:{extraFonts:[{fontFolder:"creativeData/fonts/Stag%20ATT/stagatt_italic/",fontFileName:"stagatt_medium_italic",forceTTF:!1,fontStyles:[{name:"font-style",value:"italic"}]},{fontFolder:"creativeData/fonts/Stag%20ATT/stagatt_bold/",fontFileName:"stagatt_bold",forceTTF:!1,fontStyles:[{name:"font-weight",value:"bold"}]},{fontFolder:"creativeData/fonts/Stag%20ATT/stagatt_bold_italic/",fontFileName:"stagatt_bold_italic",forceTTF:!1,fontStyles:[{name:"font-weight",value:"bold"},{name:"font-style",value:"italic"}]}]}},{fontFolder:"creativeData/fonts/Stag%20ATT/stagatt_light/",fontName:"Stag_ATT_light",fontFileName:"stagatt_light",forceTTF:!1,options:{extraFonts:[{fontFolder:"creativeData/fonts/Stag%20ATT/stagatt_light_italic/",fontFileName:"stagatt_light_italic",forceTTF:!1,fontStyles:[{name:"font-style",value:"italic"}]}]}},{fontFolder:"creativeData/fonts/Stag%20ATT/stagatt_book/",fontName:"Stag_ATT_book",fontFileName:"stagatt_book",forceTTF:!1,options:{extraFonts:[{fontFolder:"creativeData/fonts/Stag%20ATT/stagatt_book_italic/",fontFileName:"stagatt_book_italic",forceTTF:!1,fontStyles:[{name:"font-style",value:"italic"}]}]}},{fontFolder:"creativeData/fonts/Stag%20ATT/stagatt_medium/",fontName:"Stag_ATT_medium",fontFileName:"stagatt_medium",forceTTF:!1,options:{extraFonts:[{fontFolder:"creativeData/fonts/Stag%20ATT/stagatt_medium_italic/",fontFileName:"stagatt_medium_italic",forceTTF:!1,fontStyles:[{name:"font-style",value:"italic"}]}]}},{fontFolder:"creativeData/fonts/Omnes_ATT%20II/omnes_regular/",fontName:"Omnes_ATT_II",fontFileName:"omnes_regular",forceTTF:!1,options:{extraFonts:[{fontFolder:"creativeData/fonts/Omnes_ATT%20II/omnes_italic/",fontFileName:"omnes_italic",forceTTF:!1,fontStyles:[{name:"font-style",value:"italic"}]},{fontFolder:"creativeData/fonts/Omnes_ATT%20II/omnes_bold/",fontFileName:"omnes_bold",forceTTF:!1,fontStyles:[{name:"font-weight",value:"bold"}]},{fontFolder:"creativeData/fonts/Omnes_ATT%20II/omnes_bolditalic/",fontFileName:"omnes_bolditalic",forceTTF:!1,fontStyles:[{name:"font-weight",value:"bold"},{name:"font-style",value:"italic"}]}]}},{fontFolder:"creativeData/fonts/Omnes_ATT%20II/omnes_medium/",fontName:"Omnes_ATT_II_medium",fontFileName:"omnes_medium",forceTTF:!1,options:{extraFonts:[{fontFolder:"creativeData/fonts/Omnes_ATT%20II/omnes_mediumitalic/",fontFileName:"omnes_mediumitalic",forceTTF:!1,fontStyles:[{name:"font-style",value:"italic"}]}]}},{fontFolder:"creativeData/fonts/Omnes_ATT%20II/omnes_light/",fontName:"Omnes_ATT_II_light",fontFileName:"omnes_light",forceTTF:!1,options:{extraFonts:[{fontFolder:"creativeData/fonts/Omnes_ATT%20II/omnes_lightitalic/",fontFileName:"omnes_lightitalic",forceTTF:!1,fontStyles:[{name:"font-style",value:"italic"}]}]}},{fontFolder:"creativeData/fonts/ClearviewATT/clearviewatt/",fontName:"ClearviewATT",fontFileName:"clearviewatt",forceTTF:!1,options:{extraFonts:[{fontFolder:"creativeData/fonts/ClearviewATT/clearviewatt_bold_italic/",fontFileName:"clearviewatt_bold_italic",forceTTF:!1,fontStyles:[{name:"font-weight",value:"bold"},{name:"font-style",value:"italic"}]}]}},{fontFolder:"creativeData/fonts/ClearviewATT/clearviewatt_light/",fontName:"ClearviewATT_light",fontFileName:"clearviewatt_light",forceTTF:!1,options:{extraFonts:[{fontFolder:"creativeData/fonts/ClearviewATT/clearviewatt_light_italic/",fontFileName:"clearviewatt_light_italic",forceTTF:!1,fontStyles:[{name:"font-style",value:"italic"}]}]}},{fontFolder:"creativeData/fonts/ClearviewATT/clearviewatt_book/",fontName:"ClearviewATT_book",fontFileName:"clearviewatt_book",forceTTF:!1,options:{extraFonts:[{fontFolder:"creativeData/fonts/ClearviewATT/clearviewatt_book_italic/",fontFileName:"clearviewatt_book_italic",forceTTF:!1,fontStyles:[{name:"font-style",value:"italic"}]}]}},{fontFolder:"creativeData/fonts/graphik/",fontName:"Graphik",fontFileName:"Graphik-Regular-Web",forceTTF:!1,options:{extraFonts:[{fontFolder:"creativeData/fonts/graphik/",fontFileName:"Graphik-Bold-Web",forceTTF:!1,fontStyles:[{name:"font-weight",value:"bold"}]}]}},{fontFolder:"creativeData/fonts/3ds/",fontName:"ThreeDS",fontFileName:"3ds",forceTTF:!1,fontStyles:[{name:"font-style",value:"regular"}]},{fontFolder:"creativeData/fonts/3ds/",fontName:"ThreeDS-Bold",fontFileName:"3ds-Bold",forceTTF:!1,fontStyles:[{name:"font-style",value:"bold"}]},{fontFolder:"creativeData/fonts/3ds/",fontName:"ThreeDS-BoldItalic",fontFileName:"3ds-BoldItalic",forceTTF:!1,fontStyles:[{name:"font-style",value:"italic"}]},{fontFolder:"creativeData/fonts/3ds/",fontName:"ThreeDS-Condensed",fontFileName:"3ds-Condensed",forceTTF:!1,fontStyles:[{name:"font-style",value:"condensed"}]},{fontFolder:"creativeData/fonts/3ds/",fontName:"ThreeDS-CondensedBold",fontFileName:"3ds-CondensedBold",forceTTF:!1,fontStyles:[{name:"font-style",value:"bold"}]},{fontFolder:"creativeData/fonts/3ds/",fontName:"ThreeDS-CondensedLight",fontFileName:"3ds-CondensedLight",forceTTF:!1,fontStyles:[{name:"font-style",value:"light"}]},{fontFolder:"creativeData/fonts/3ds/",fontName:"ThreeDS-ExtraLight",fontFileName:"3ds-ExtraLight",forceTTF:!1,fontStyles:[{name:"font-style",value:"light"}]},{fontFolder:"creativeData/fonts/3ds/",fontName:"ThreeDS-ExtraLightItalic",fontFileName:"3ds-ExtraLightItalic",forceTTF:!1,fontStyles:[{name:"font-style",value:"light italic"}]},{fontFolder:"creativeData/fonts/3ds/",fontName:"ThreeDS-Italic",fontFileName:"3ds-Italic",forceTTF:!1,fontStyles:[{name:"font-style",value:"italic"}]},{fontFolder:"creativeData/fonts/3ds/",fontName:"ThreeDS-Light",fontFileName:"3ds-Light",forceTTF:!1,fontStyles:[{name:"font-style",value:"light"}]},{fontFolder:"creativeData/fonts/3ds/",fontName:"ThreeDS-SemiBold",fontFileName:"3ds-SemiBold",forceTTF:!1,fontStyles:[{name:"font-style",value:"semi-bold"}]},{fontFolder:"creativeData/fonts/3ds/",fontName:"ThreeDS-SemiBoldItalic",fontFileName:"3ds-SemiBoldItalic",forceTTF:!1,fontStyles:[{name:"font-style",value:"semi-bold italic"}]},{fontFolder:"creativeData/fonts/buenosaires-bold/",fontName:"Buenos_Aires_Bold",fontFileName:"buenosaires-bold",forceTTF:!1,fontStyles:[{name:"font-style",value:"bold"}]},{fontFolder:"creativeData/fonts/buenosaires-light/",fontName:"Buenos_Aires_Light",fontFileName:"buenosaires-light",forceTTF:!1},{fontFolder:"creativeData/fonts/buenosaires-regular/",fontName:"Buenos_Aires_Regular",fontFileName:"buenosaires-regular",forceTTF:!1}],this.element=e('<div class="widget studio-widget"><div class="background"></div><div class="widget-panel animates-in"></div></div>'),t.preventPauseOnClick&&(this.element=e('<div class="widget studio-widget"><div class="widget-panel animates-in"></div></div>')),this._super(t),this.getFont("creativeData/fonts/WWOne/","WW-Normal","WW-Normal"),this.getFont("creativeData/fonts/Gotham-Medium/","Gotham-Medium","Gotham-Medium"),this.getFont("creativeData/fonts/Proxima_Nova_Reg/","Proxima_Nova_Reg","Proxima_Nova_Reg")},loadWidgetData:function(e){i.getOverlayDataCdn(d.overlayId,function(t){e(t)},function(){d.loadWidgetDataFail()})},dataLoaded:function(e){d.populateWidget(e)},closeClick:function(t){var a=this._super,o=["left","top","right","bottom"];e(d.element).find(".animates-in").removeClass("animates-in").addClass("animates-out"),e(d.element).find("iframe").remove(),window.setTimeout(function(){e(d.element).find(".animates-out").removeClass("show");var n=e(d.element).find(".widget-panel");t.animation&&o.indexOf(t.animation)>-1?"right"===t.animation?n.css({"margin-left":"200%"}):"top"===t.animation?n.css({"margin-top":"-200%"}):"bottom"===t.animation?n.css({"margin-top":"200%"}):n.css({"margin-left":"-200%"}):n.css({left:"-50%"}),window.setTimeout(function(){a()},500)},100),clearInterval(d.carouselAutpolay)},show:function(){},setPanelCoords:function(e,t,a,o,n){a?e.css({height:t.height/o*100+"%",width:t.width/n*100+"%",top:t.top/o*100+"%",left:t.left/n*100+"%"}):e.css({height:t.height+"px",width:t.width+"px",top:t.top+"px",left:t.left+"px"})},drawFacebookIcon:function(t,a,o){var s=n(t[0],"100%","100%");s.setViewBox(0,0,12,27,!1);var r=s.set();r.attr({id:"Page-1",name:"Page1"});var c=s.set();c.attr({id:"Custom-Preset",parent:"Page1",name:"CustomPreset"});var f=s.set();f.attr({id:"AmazonOverlay",parent:"Page1",name:"AmazonOverlay"});var m=s.set();m.attr({id:"fb_vice-01-01",parent:"Page1",name:"fb_vice0101"}),m.transform("t1312.000000, 180.000000");var u=s.set(),p=s.path("M2.8,26.5h5.1V13.4h3.6L11.9,9h-4V6.5c0-1,0.2-1.4,1.2-1.4h2.8V0.5H8.4 c-3.8,0-5.5,1.7-5.5,5V9H0.1v4.5h2.7L2.8,26.5L2.8,26.5z").attr({id:"Shape",parent:"Page1",fill:"#404041","stroke-width":"0","stroke-opacity":"1"}).data("id","Shape");u.attr({id:"Layer_1_1_",parent:"Page1",name:"Layer_1_1_"});r.push(),c.push(),f.push(),m.push(),u.push(p),e(t).bind(l.CLICK_EVENT,function(){i.widgetShareClick("fb",a,o,null,d.tag.spriteId)})},drawTwitterIcon:function(t,a,o){var s=n(t[0],"100%","100%");s.setViewBox(0,0,33,27,!1);var r=s.set();r.attr({id:"Page-1",name:"Page1"});var c=s.set();c.attr({id:"Custom-Preset",parent:"Page1",name:"CustomPreset"});var f=s.set(),m=s.set();m.attr({id:"tweet",parent:"Page1",name:"tweet"});var u=s.set(),p=s.path("M0.5,23.5c2.9,1.9,6.4,3,10.1,3c12.2,0,19.1-10.3,18.6-19.6c1.3-0.9,2.4-2,3.3-3.4 c-1.2,0.6-2.4,0.9-3.8,1c1.3-0.8,2.4-2.1,2.9-3.6c-1.3,0.8-2.7,1.3-4.2,1.6c-1.2-1.3-2.9-2-4.8-2c-4.2,0-7.3,3.9-6.4,8.1 C10.8,8.4,5.9,5.7,2.7,1.8c-1.7,3-0.9,6.8,2,8.7c-1.1,0-2.1-0.3-3-0.8c-0.1,3.1,2.1,5.9,5.3,6.5c-0.9,0.2-2,0.3-3,0.1 c0.9,2.6,3.2,4.5,6.1,4.6C7.5,22.9,4,23.9,0.5,23.5L0.5,23.5z").attr({id:"Shape",parent:"Page1",fill:"#404041","stroke-width":"0","stroke-opacity":"1"}).data("id","Shape");u.attr({id:"Layer_1_1_",parent:"Page1",name:"Layer_1_1_"});r.push(),c.push(),f.push(),m.push(),u.push(p),e(t).bind(l.CLICK_EVENT,function(){i.widgetShareClick("tw",a,o,null,d.tag.spriteId)})},populateAmazonPanel:function(t,a){d.aggresiveScaling=!0,t.append('<div class="ww-amazon-product-container"><div class="ww-amazon-product-header"><div class="ww-amazon-header-logo"></div><div class="ww-amazon-header-close"><div class="amazon-facebook-share"></div><div class="amazon-twitter-share"></div><div class="amazon-close-button close-button-event">CLOSE</div></div></div><div class="ww-amazon-product-carousel wwx-carousel"></div><div class="ww-amazon-product-text"><div class="ww-amazon-product-title wwx-text"></div><div class="ww-amazon-product-price wwx-text"></div><div class="ww-amazon-product-description wwx-text"></div></div><div class="ww-amazon-product-buy-button wwx-button"></div></div>');var n=t.find(".ww-amazon-product-carousel"),s=t.find(".ww-amazon-product-title"),r=t.find(".ww-amazon-product-price"),c=t.find(".ww-amazon-product-description"),f=t.find(".ww-amazon-product-buy-button"),m={carouselSettings:{element:n,fn:d.populateCarouselPanel,content:o.pluck(a.content.images,"url")},titleSettings:{element:s,fn:d.populateTextPanel,content:a.content.productTitle},priceSettings:{element:r,fn:d.populateTextPanel,content:a.content.price},descriptionSettings:{element:c,fn:d.populateTextPanel,content:a.content.features},buttonSettings:{element:f,fn:d.populateButtonPanel,content:a.content.buyMessage}};m.buttonSettings.fn=function(e,t){t.backgroundColor="#ff9900",d.populateButtonPanel(e,t);var o="UK"===a.content.region?"co.uk":"com";e.find(".button-content").append('<form method="POST" target="_blank" action="http://www.amazon.'+o+"/exec/obidos/dt/assoc/handle-buy-box="+a.content.productId+'"><input type="hidden" name="asin.'+a.content.productId+'" value="1"><input type="hidden" name="tag-value" value="'+(a.content.affiliateId||"")+'"></form>'),e.unbind(l.CLICK_EVENT),e.bind(l.CLICK_EVENT,function(){e.find("form").submit()})};var u=e("<div>"+a.content.productTitle+"</div>").text()+" - "+a.content.buyUrl;d.drawTwitterIcon(t.find(".amazon-twitter-share"),u,a.content.buyUrl),d.drawFacebookIcon(t.find(".amazon-facebook-share"),u,a.content.buyUrl),t.find(".ww-amazon-header-logo").bind(l.CLICK_EVENT,function(){i.widgetLinkClick(d.appRef,d.tag.nameLink,"http://www.amazon.com","",d.tag.spriteId,!1,!1,d.tag.publicData)}),o.each(a.settings,function(e){try{"string"==typeof e.value&&(e.value=JSON.parse(e.value));var t=m[e.name];t.fn(t.element,{settings:e.value.settings,content:t.content},e.value.color)}catch(e){console.log(e)}})},populateTextPanel:function(e,t){e.css({"background-color":t.backgroundColor}),e.append('<div class="panel-content">'+t.content+"</div>");var a=t.settings;if(o.each(a,function(t){"Font Color"===t.name&&e.css({color:t.value}),"Font Size"===t.name&&e.css({"font-size":t.value-1})}),t.customCss){var n={};o.each(t.customCss,function(e){n[e.property]=e.value}),e.find(".panel-content > *").css(n)}d.postAnimationCallbacks.push(function(){e.find(".panel-content").height()-30>e.height()&&(e.addClass("scroll"),new s(e[0],{checkDOMChanges:!0,vScroll:!0,hScroll:!1,draggableScrollbars:!0}))})},populateCarouselPanel:function(t,a){function n(){h==T-1?f.scrollToPage(0,0,1e3):f.scrollToPage("next",0,1e3)}function r(){0==h?f.scrollToPage(T-1,0,1e3):f.scrollToPage("prev",0,1e3)}var c,f,m,u,p,g,v,h,w,T=a.content.length,b=e('<div class="main-image-wrapper"  style=""></div>'),F=e('<ul class="carousel-image-container" style="width:'+100*T+'%"></ul>'),y=e('<div class="thumbs-wrapper" style=""></div>'),_=e('<ul class="carousel-thumbnails" style="width:'+33.33333333*T+'%"></ul>'),C=e('<ul class="ww-carousel-navigation"></ul>'),S=e('<p class="index-text"><span class="current-page-number">1</span>/<span>'+T+"</span></p>"),N={left:e('<div class="arrow left"><svg id="arrowHeadLeft" xmlns="http://www.w3.org/2000/svg" width="100%" height="100%" viewBox="-4 -4 108 108"><path stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" d="M74.75 99.5L25.25 50 74.75.5" fill-opacity="0"></path><desc>Created with Snap</desc><defs></defs></svg></div>'),right:e('<div class="arrow right"><svg id="arrowHeadRight" xmlns="http://www.w3.org/2000/svg" width="100%" height="100%" viewBox="-4 -4 108 108"><path stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" d="M25.2.5L74.8 50 25.2 99.5" fill-opacity="0"></path><desc>Created with Snap</desc><defs></defs></svg></div>')};if(o.each(a.content,function(t,a){t=t.replace(/wirewax-studio-media.s3.amazonaws.com/g,"studio-media.wirewax.com"),u=e('<li class="carousel-image" style="width:'+1e4/(100*T)+'%"></li>'),p=u.clone(),d.toolkit.waxImage(u,t,!0,!1,null,!0),d.toolkit.waxImage(p,t,!0,!1,null,!0),C.append('<li class="ww-carousel-navigation-item '+(0===a?"active":"")+" ww-carousel-navigation-item-"+a+'"></li>'),F.append(u),_.append(p)}),b.append(F),y.append(_),t.append(b),t.mouseover(function(){w=!0}),t.mouseout(function(){w=!1}),a.content.length>1?(m=t.find(".main-image-wrapper"),f=new s(m[0],{vScroll:!1,hScroll:!0,disableMouse:!1,disablePointer:!1,checkDOMChanges:!0,snap:!0,mouseWheel:!0,hScrollbar:!1,vScrollbar:!1,momentum:!1,onScrollStart:function(){t.find(".ww-carousel-navigation li.active").removeClass("active")},onScrollEnd:function(){h=this.currPageX;var e=Math.floor(h/3);c&&c.scrollToPage(e,0,1e3);var a=t.find(".current-page-number");a&&a.html(h+1),t.find(".ww-carousel-navigation-item-"+this.currPageX).addClass("active")}}),o.each(a.settings,function(a){if("Link"===a.name&&a.value&&(-1===a.value.indexOf("http")&&(a.value="http://"+a.value),t.find(".main-image-wrapper .carousel-image").css({cursor:"pointer"}).bind(l.CLICK_EVENT,function(){i.widgetLinkClick(d.appRef,d.tag.nameLink,a.value,"",d.tag.spriteId,!1,!1,d.tag.publicData)})),"Autoplay"!==a.name||"true"!==a.state&&!0!==a.state||(d.carouselAutpolay=setInterval(function(){w||n()},3e3)),"Numbers"!==a.name||"true"!==a.state&&!0!==a.state||t.append(S),"Controls"!==a.name||"true"!==a.state&&!0!==a.state||(t.append(N.left),t.append(N.right),e(N.left).on(l.CLICK_EVENT,function(e){r()}),e(N.right).on(l.CLICK_EVENT,function(e){n()})),"Thumbnails"!==a.name||"true"!==a.state&&!0!==a.state||(e(N.left).addClass("thumbnail-arrow"),e(N.right).addClass("thumbnail-arrow"),t.find(".main-image-wrapper").addClass("with-thumbs"),t.append(y),g=t.find(".thumbs-wrapper"),c=new s(g[0],{vScroll:!1,hScroll:!0,disableMouse:!1,disablePointer:!1,checkDOMChanges:!0,snap:!0,mouseWheel:!0,hScrollbar:!1,vScrollbar:!1,momentum:!1}),v=t.find(".thumbs-wrapper li"),e(v).on(l.CLICK_EVENT,function(t){var a=e(this).index();f.scrollToPage(a,0,1e3)})),"Buttons"===a.name&&1==a.state){t.append(C);var o=t.find(".ww-carousel-navigation li");e(o).on(l.CLICK_EVENT,function(a){var o=e(this).index();t.find(".ww-carousel-navigation li.active").removeClass("active"),e(this).addClass("active"),f.scrollToPage(o,0,1e3)})}})):o.each(a.settings,function(e){"Link"===e.name&&e.value&&(-1===e.value.indexOf("http")&&(e.value="http://"+e.value),t.find(".main-image-wrapper .carousel-image").css({cursor:"pointer"}).bind(l.CLICK_EVENT,function(){i.widgetLinkClick(d.appRef,d.tag.nameLink,e.value,"",d.tag.spriteId,!1,!1,d.tag.publicData)}))}),a.customCss){var k={};o.each(a.customCss,function(e){k[e.property]=e.value}),t.find(".carousel-image").css(k)}},populateVideoPanel:function(t,a){var n=function(t){var a={youtube:/^.*(youtu.be\/|v\/|embed\/|watch\?|youtube.com\/user\/[^#]*#([^\/]*?\/)*)\??v?=?([^#\&\?]*).*/,vimeo:/https?:\/\/(?:www\.|player\.)?vimeo.com\/(?:channels\/(?:\w+\/)?|groups\/([^\/]*)\/videos\/|album\/(\d+)\/video\/|video\/|)(\d+)(?:$|\/|\?)/,wirewax:/(https|http):\/\/(?:www\.embed\.|embed\.)?wirewax\.?(tv|com)\//},o={},n=t.length<20&&!t.match(/[^A-z|0-9]/g)||t.match(/youtube\.com/g)||t.match(/youtu\.be/g),i=t.match(/vimeo/g);return isWirewax=t.match(/wirewax/g),n?(o.vidId=t.match(/[^A-z|0-9]/g)?t.match(a.youtube)[3]:t,o.embed="https://www.youtube.com/embed/"+o.vidId,o.img="http://img.youtube.com/vi/"+o.vidId+"/0.jpg"):i?(o.vidId=t.match(a.vimeo)[3],o.embed="https://player.vimeo.com/video/"+o.vidId,e.ajax({type:"GET",url:"http://vimeo.com/api/v2/video/"+o.vidId+".json",jsonp:"callback",dataType:"jsonp",success:function(e){o.img=e[0].thumbnail_large}})):isWirewax?(o.vidId=t.split(a.wirewax)[3],o.embed="https://embed.wirewax.com/"+o.vidId,o.img="public/offline/vidData/"+o.vidId+"/"+o.vidId+"_still.jpg"):(o.vidId=t,o.img="//img.youtube.com/vi/"+t+"/0.jpg",o.embed="https://www.youtube.com/embed/"+t),o}(a.content);if(window.callPhantom)return void t.append('<img width="100%" height="100%" src="'+n.img+'" />');var i=a.settings,s=0;o.each(i,function(e){"Autoplay"!==e.name||"true"!==e.state&&!0!==e.state||(s=1)});var r=e('<iframe height="100%" width="100%" style="position:absolute; left:0; top: 0;" src="'+n.embed+"?wmode=opaque&autoplay="+s+'" frameborder="0" allowfullscreen allow="autoplay"></iframe>');(l.IS_CHROME&&document.fullscreenElement||document.mozFullscreenElement||document.webkitFullscreenElement||document.msFullscreenElement)&&r.removeAttr("allowfullscreen"),t.append(r)},populateIframePanel:function(t,a){a.content&&!window.wirewax.forceWidgetsOpenOnLoad&&d.postAnimationCallbacks.push(function(){-1!==a.content.indexOf("<iframe")?t.append(e(a.content)):t.append('<iframe src="'+a.content+'" height="100%" width="100%" style="position:absolute; left:0; top: 0;" scrolling="yes"></iframe>')})},populateButtonPanel:function(t,a,n){a.backgroundColor=n||a.backgroundColor||"#7bafa8",a.hoverColor="white",a.fontHoverColor="#303030",a.fontColor="#303030","rgba(255, 255, 255, 1)"===a.backgroundColor&&(a.hoverColor="#303030",a.fontHoverColor="white"),t.append('<div class="button-container" style="background-color: '+a.backgroundColor+"; border-color: "+a.backgroundColor+';">   <span class="button-content">'+a.content+"</span></div>");var s=a.settings,r=!1;o.each(s,function(e){"Font Color"===e.name&&(t.css({color:e.value}),a.fontColor=e.value),"Font Size"===e.name&&t.css({"font-size":e.value-1}),"Radius"===e.name&&t.find(".button-container").css({"border-radius":e.value}),"Link"===e.name&&e.value&&(-1===e.value.indexOf("http")&&(e.value="http://"+e.value),t.bind(l.CLICK_EVENT,function(){r||i.widgetLinkClick(d.appRef,d.tag.nameLink,e.value,"",d.tag.spriteId,!1,!1,d.tag.publicData)})),"Add to cart"===e.name&&e.hasOwnProperty("state")&&(r="false"!==e.state&&("true"===e.state||!!e.state)),"Product"===e.name&&e.value&&t.bind(l.CLICK_EVENT,function(){r&&(i.recordUiMetric("addToCart:"+e.value,d.appRef||null,0,d.tag&&d.tag.nameLink,d.tag&&d.tag.spriteId,l.WIDGET_METRIC_TYPES.ADD_TO_CART),c.publish(l.PRODUCT_ADD_TO_CART,{name:e.value}))})});var f=t.find(".button-container"),m={};a.customCss&&(o.each(a.customCss,function(e){m[e.property]=e.value}),f.css(m)),f.on("mouseenter",function(){e(this).css(o.extend({"background-color":a.hoverColor,color:a.fontHoverColor},m))}),f.on("mouseleave",function(){e(this).css(o.extend({"background-color":a.backgroundColor,color:a.fontColor},m))})},populateMapPanel:function(e,t){var a=14,n="interactive",i=!0;o.each(t.settings,function(t){"Zoom"===t.name&&(a=t.value||a),"Monochrome"===t.name&&t.state&&"true"===t.state&&e.addClass("monochrome"),"Marker"===t.name&&t.state&&"true"!==t.state&&(n="static",i=!1)});var l='<iframe src="https://www.google.com/maps/embed/v1/place?key=AIzaSyBM60MvJW4-8Vs8Azxn_nko3VcMyqew4l0&q='+encodeURIComponent(t.content)+"&zoom="+a+'" height="100%" width="100%" style="position:absolute; left:0; top: 0;"></iframe>';"static"===n&&(l='<img src="https://maps.googleapis.com/maps/api/staticmap?key=AIzaSyBM60MvJW4-8Vs8Azxn_nko3VcMyqew4l0&center='+encodeURIComponent(t.content)+"&zoom="+a+"&size="+e.width()+"x"+e.height()+'"  height="100%" width="100%" style="position:absolute; left:0; top: 0;">'),t.content&&d.postAnimationCallbacks.push(function(){e.append(l)})},populateShape:function(e,t){t.backgroundColor=t.backgroundColor||"#fafafa",e.css({"background-color":t.backgroundColor}),o.each(t.settings,function(t){"Radius"===t.name&&e.css({"border-radius":t.value+"%"})})},drawCloseButton:function(t){if(t&&t.length){var a=n(t[0],"100%","100%");a.setViewBox(432.3,12.8,255.3,255.2,!1);var o=a.path("M682.9,240.7c6.2,6.2,6.2,16.3,0,22.5c-3.1,3.1-7.2,4.7-11.3,4.7s-8.2-1.6-11.3-4.7L559.9,162.9L459.6,263.2  c-3.1,3.1-7.2,4.7-11.3,4.7s-8.2-1.6-11.3-4.7c-6.2-6.2-6.2-16.3,0-22.5l100.3-100.3L437.1,40.1c-6.2-6.2-6.2-16.3,0-22.6  c6.2-6.2,16.3-6.2,22.5,0l100.3,100.3L660.4,17.4c6.2-6.2,16.3-6.2,22.5,0s6.2,16.3,0,22.5L582.6,140.3L682.9,240.7z");o.attr({fill:"white","stroke-width":"1","stroke-opacity":"1"}).data("id","path_c");var i=n.animation({transform:"r90"},300),s=n.animation({transform:"r0"},300);"touchend"!==l.CLICK_EVENT&&e(t).hover(function(){o.animate(i)},function(){o.animate(s)})}},scaleWidget:function(t,a){var o=e("#tag-overlay").width(),n=o/a;d.aggresiveScaling&&(o<.5*a?n+=.05:o<.75*a&&(n+=.075)),d.linearScaling||(n=n.toFixed(1)),d.noScale||l.IS_CHROME&&l.IS_DESKTOP||l.IS_SAFARI&&l.IS_DESKTOP?t.css({zoom:n}):l.IS_FIREFOX?t.css({transform:"scale("+n+")"}):t.css({transform:"scale("+n+") translateZ(0)","-webkit-transform":"scale("+n+")  translateZ(0)"})},setWidgetInitialPosition:function(e,t,a,o,n,i){var l=["left","top","right","bottom"];i&&l.indexOf(i)>-1&&(a=0===e.left?"right"===i?{"margin-left":"200%","margin-top":"0"}:"left"===i?{"margin-left":"-200%","margin-top":"0"}:"top"===i?{"margin-top":"-200%","margin-left":"0"}:{"margin-top":"200%","margin-left":"0"}:"right"===i?{left:"200%",top:"50%","margin-left":"-"+o/2+"px","margin-top":"-"+n/2+"px"}:"left"===i?{left:"-200%",top:"50%","margin-left":"-"+o/2+"px","margin-top":"-"+n/2+"px"}:"top"===i?{top:"-200%",left:"50%","margin-left":"-"+o/2+"px","margin-top":"-"+n/2+"px"}:{top:"200%",left:"50%","margin-left":"-"+o/2+"px","margin-top":"-"+n/2+"px"},t.css(a))},setWidgetFinalPosition:function(e,t){var a;a=0===e.left?{"margin-top":"0","margin-left":"0"}:d.noScale&&l.IS_FIREFOX?{transform:"translate(-50%, -50%)",top:"50%",left:"50%","margin-left":"0","margin-top":"0"}:{left:"50%",top:"50%"},t.css(a)},populateWidget:function(t){var a=this._super,n=d.element.find(".widget-panel");t.overlayPanels=o.sortBy(t.overlayPanels,function(e){return e.col}),!1===t.enableCloseOverlayAbility||t.hideCloseButton||n.append('<div class="close-button close-button-event animates-in"></div>'),t.overlayPanels&&1===t.overlayPanels.length&&"iframe"===t.overlayPanels[0].type&&!l.IS_IE_11&&(d.noScale=!0),d.noScale?n.css({height:parseInt((t.height+1)/574*100)+"%",width:parseInt((t.width+1)/1020*100)+"%",background:t.backgroundColor,display:"none"}):n.css({height:t.height+1+"px",width:t.width+1+"px",background:t.backgroundColor,display:"none"}),o.each(t.overlayPanels,function(a,i){var l=a.positionPx[0],s=e('<div class="wwx-panel wwx-'+a.type+" animates-in wwx-panel-index wwx-panel-index-"+i+'"></div>');d.setPanelCoords(s,l,d.noScale,t.height,t.width),"text"===a.type?d.populateTextPanel(s,a):"carousel"===a.type?d.populateCarouselPanel(s,a):"button"===a.type?d.populateButtonPanel(s,a):"iframe"===a.type?d.populateIframePanel(s,a):"map"===a.type?d.populateMapPanel(s,a):"video"===a.type?d.populateVideoPanel(s,a):"amazon"===a.type?(d.element.find(".close-button").remove(),d.populateAmazonPanel(s,a)):a.type.includes("shape-")&&d.populateShape(s,a),("string"==typeof a.content||a.content instanceof String)&&o.each(d.customFonts,function(e){!e.alreadyAdded&&a.content.match(e.fontName)&&(d.getFont(e.fontFolder,e.fontName,e.fontFileName,e.forceTTF,e.options),e.alreadyAdded=!0)}),n.append(s)});var i={display:"block",opacity:1,transition:"all 200ms ease-out"},s="50%",r="50%";if(0===t.left&&(i.left="0%",i["margin-left"]="0px",s="0",r="0"),d.noScale&&0===t.left&&(i.left="0%",i["margin-left"]="0px",s="0"),n.css(i),t.animation)var c=t.animation;else var c="left";d.setWidgetInitialPosition(t,n,i,t.width,t.height,c),d.linearScaling=0===t.left,1020-t.width<50&&(n.addClass("inner-close"),d.linearScaling=!0,d.aggresiveScaling=!1),n.css({"transform-origin":s+" "+r}),d.scaleWidget(n,1020),e(window).resize(function(){window.setTimeout(function(){d.scaleWidget(n,1020),d.setWidgetFinalPosition(t,n)},100)}),window.setTimeout(function(){d.setWidgetFinalPosition(t,n),window.setTimeout(function(){e(d.element).find(".animates-in").addClass("show"),window.setTimeout(function(){o.each(d.postAnimationCallbacks,function(e){e&&"function"==typeof e&&e()}),d.postAnimationCallbacks=[]})},100)},500),!1!==t.enableCloseOverlayAbility&&this.element.find(".background").on(l.CLICK_EVENT,function(){d.closeClick(t)}),!1===t.enableCloseOverlayAbility||t.hideCloseButton||(this.element.find(".close-button-event").on(l.CLICK_EVENT,function(){d.closeClick(t)}),this.drawCloseButton(this.element.find(".close-button"))),a()}})});